<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <link href="https://fonts.googleapis.com/css?family=Merriweather:300,700" rel="stylesheet">
  <meta name="author" content="Geoffrey Litt and Daniel Jackson" />
  <title>Wildcard: Spreadsheet-Driven Customization of Web Applications</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="basic.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>

<p style="background-color: #e50000;
color: white;
font-weight: bold;
padding: 10px; margin: 20px 0 0 0;">In-progress DRAFT. Please don't distribute!</p>

<header id="title-block-header">
<h1 class="title">Wildcard: Spreadsheet-Driven Customization of Web Applications</h1>
<p class="author"><a href="https://www.geoffreylitt.com/">Geoffrey Litt</a> and <a href="http://people.csail.mit.edu/dnj/">Daniel Jackson</a></p>
</header>
<p>Many Web applications do not meet the particular needs of their users. Browser extensions and user scripts offer a way to customize web applications, but most people do not have the programming skills to implement their own extensions.</p>
<p>We present the idea of <em>spreadsheet-driven customization</em>: enabling end users to customize existing applications using a live spreadsheet view of the data inside the application. By manipulating the spreadsheet, users can implement a wide variety of customizations, ranging from sorting lists of search results to displaying related data from other web services, without doing any traditional programming.</p>
<p>We built a prototype system called Wildcard that implements spreadsheet-driven customization as a web browser extension. Through concrete examples, we demonstrate that Wildcard has both a low barrier to entry for beginners and enough flexibility to solve many useful problems. We also show that Wildcard can work with real existing websites, by extracting structured data using web scraping techniques.</p>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#demo-booking-a-trip-with-wildcard"><span class="toc-section-number">2</span> Demo: booking a trip with Wildcard</a>
<ul>
<li><a href="#customizing-search-results"><span class="toc-section-number">2.1</span> Customizing search results</a></li>
<li><a href="#customizing-a-form-input"><span class="toc-section-number">2.2</span> Customizing a form input</a></li>
</ul></li>
<li><a href="#system-architecture"><span class="toc-section-number">3</span> System Architecture</a></li>
<li><a href="#design-principles"><span class="toc-section-number">4</span> Design principles</a>
<ul>
<li><a href="#expose-a-universal-data-structure"><span class="toc-section-number">4.1</span> Expose a universal data structure</a></li>
<li><a href="#low-floor-high-ceiling"><span class="toc-section-number">4.2</span> Low floor, high ceiling</a></li>
<li><a href="#build-for-multiple-tiers-of-users"><span class="toc-section-number">4.3</span> Build for multiple tiers of users</a></li>
</ul></li>
<li><a href="#related-work"><span class="toc-section-number">5</span> Related work</a>
<ul>
<li><a href="#malleable-software"><span class="toc-section-number">5.1</span> Malleable software</a></li>
<li><a href="#web-customization"><span class="toc-section-number">5.2</span> Web customization</a></li>
<li><a href="#spreadsheet-based-app-builders"><span class="toc-section-number">5.3</span> Spreadsheet-based app builders</a></li>
<li><a href="#web-scraping-data-extraction"><span class="toc-section-number">5.4</span> Web scraping / data extraction</a></li>
</ul></li>
<li><a href="#future-work"><span class="toc-section-number">6</span> Future work</a></li>
<li><a href="#conclusion"><span class="toc-section-number">7</span> Conclusion</a></li>
<li><a href="#bibliography">References</a></li>
</ul>
</nav>
<h1 data-number="1" id="introduction" data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Web applications often don’t match the particular needs of their users. Sometimes there is a browser extension available to patch an issue, and if the user is a programmer they might be able to fix it themselves. But for most people, the only recourse is to complain to the developers, or more likely, to simply give up. Back in 1977, in <em>Personal Dynamic Media</em> <span class="citation" data-cites="kay1977">[<a href="#ref-kay1977" role="doc-biblioref">14</a>]</span>, Alan Kay envisioned personal computing as a medium that let a user “mold and channel its power to his own needs,” but today, software feels more like concrete than clay.</p>
<p>In this paper, we present <em>spreadsheet-driven customization</em>, a technique that enables end users to customize software. The idea is to augment an application’s UI with a spreadsheet that is synchronized with the application’s data. When the user manipulates the spreadsheet, the underlying data is modified and the changes are propagated to the UI, and vice versa. We have implemented this technique in a prototype browser extension called Wildcard. Section 2 presents demos of using Wildcard to augment real websites in useful ways, and Section 3 describes the implementation of the extension.</p>
<figure>
<img src="media/overview-300dpi.png" id="fig:overview" alt="" /><figcaption>An overview of spreadsheet-driven customization</figcaption>
</figure>
<p>Spreadsheet-driven customization provides an easy entry point for end users, since small tweaks can be performed with a single click. At the same time, it also supports a variety of richer customizations, like adding private annotations to a webpage or joining in related data from a web API. In Section 4, we elaborate on this principle of “low floor, high ceiling,” as well as other design principles guiding our work.</p>
<p>Prior work <span class="citation" data-cites="mccutchen2016 benson2014 chang2014">[<a href="#ref-benson2014" role="doc-biblioref">3</a>, <a href="#ref-chang2014" role="doc-biblioref">5</a>, <a href="#ref-mccutchen2016" role="doc-biblioref">19</a>]</span> has enabled end users to create “spreadsheet-driven applications” which use spreadsheets as a backing data layer. Spreadsheet-driven <em>customization</em> applies this idea in a different context: customizing existing software, rather than building new software from scratch. Our technique does not require that the application actually be backed by a spreadsheet; it merely uses the spreadsheet as an interface for viewing and modifying the internal state of the application.</p>
<p>This approach requires extracting structured data from the user interfaces of existing applications, but we hide the complexity of data extraction from end users. Programmers write <em>site adapters</em> which use web scraping techniques to extract structured data from existing applications and map them to the spreadsheet table. End users only interact with the structured spreadsheet, providing a straightforward customization experience. In Section 5, we explain this architecture in more depth, and describe how Wildcard relates to existing work on malleable software, web customization, spreadsheet-driven applications, and web scraping.</p>
<p>The Wildcard extension is currently an early research prototype. We plan to continue testing the system with our own use cases to understand better how well the spreadsheet abstraction maps to real websites and customization needs. Eventually we plan to release the tool publicly, in order to study how end users choose to customize applications, discover usability challenges, and to test the feasibility of programmers building and maintaining site adapters.</p>
<h1 data-number="2" id="demo-booking-a-trip-with-wildcard" data-number="2"><span class="header-section-number">2</span> Demo: booking a trip with Wildcard</h1>
<p>To get a sense of the user experience of using Wildcard, let’s see an example of someone using it to help with booking a trip.<span class="pdf-only"></span></p>
<div class="pdf-only">

</div>
<h2 data-number="2.1" id="customizing-search-results" data-number="2.1"><span class="header-section-number">2.1</span> Customizing search results</h2>
<p>In 2012, the travel site Airbnb removed the ability to sort accommodation listings by price. Users could still filter by price range, but could no longer view the cheapest listings first. Many users complained on online message boards that the change seemed hostile to users. “It’s so frustrating!..What is the logic behind not having this function?” said one user on the <a href="https://community.withairbnb.com/t5/Hosting/Sorting-listing-by-price/td-p/559404">Airbnb support forum</a>. Alas, the feature remains missing to this day.</p>
<p>Using Wildcard, the user can fix this omission, while leaving the page’s design and the rest of its functionality unchanged.<span class="pdf-only"></span> First, the user opens up the Wildcard panel, which shows a table corresponding to the search results in the page. As they click around in the table, the corresponding row in the page is highlighted so they can see the connection between the views.</p>
<video width="100%" controls="controls" preload="auto" muted="muted" src="media/table.mp4#t=0.1" muted playsinline controls class>
</video>
<p>Then, the user clicks on the price column header to sort the spreadsheet, and the Airbnb UI, by in ascending order by price<span class="pdf-only"></span>. They can similarly use the column headers to filter to listings with a user rating above 4.5, which the original Airbnb UI also doesn’t allow.</p>
<video width="100%" controls="controls" preload="auto" muted="muted" src="media/sort-filter.mp4#t=0.1" muted playsinline controls class>
</video>
<p>After manipulating the data, the user closes the table view and continues using the website with its original visual design. The table view offers a way to change the data backing a page, but does not need to replace the original interface entirely.</p>
<p>Most websites that show lists of data also offer actions on rows in the table, like adding an item to a shopping cart. Wildcard has the ability to make these “row actions” available in the data table through the site adapter.</p>
<p>In the Airbnb UI, saving multiple listings to a Favorites list requires tediously clicking through them one by one. Using Wildcard, the user can select multiple rows and favorite all of them with a single click<span class="pdf-only"></span>. Similarly, the user can also open the detailed pages for many listings at once.</p>
<video width="100%" controls="controls" preload="auto" muted="muted" src="media/favorite-open.mp4#t=0.1" muted playsinline controls class>
</video>
<p>Now the user wants to jot down some notes on the pros and cons of each listing. To do this, they type some notes into an additional column in each listing row, and the notes appear inside the listings in the original UI<span class="pdf-only"></span>. The annotations are saved in the browser for future sessions.</p>
<video width="100%" controls="controls" preload="auto" muted="muted" src="media/annotate.mp4#t=0.1" muted playsinline controls class>
</video>
<p>Wildcard also includes a formula language, which enables more sophisticated customizations that fetch external data and perform computations.</p>
<p>When traveling without a car, it’s useful to evaluate potential places to stay based on how walkable the surroundings are. Using Wildcard formulas, the user can integrate Airbnb with Walkscore, an API that rates the walkability of any location on a 1-100 scale. When they type in a <code>WALKSCORE</code> formula with the latitude and longitude of the listing, it returns the walk score as the cell’s value. Because the cell’s contents are injected into the page, the score also shows up in the page body<span class="pdf-only"></span>.</p>
<video width="100%" controls="controls" preload="auto" muted="muted" src="media/walkscore.mp4#t=0.1" muted playsinline controls class>
</video>
<div class="pdf-only">

</div>
<h2 data-number="2.2" id="customizing-a-form-input" data-number="2.2"><span class="header-section-number">2.2</span> Customizing a form input</h2>
<p>It might seem that Wildcard is only useful on websites that display lists of tabular data like search results. But in fact, the table metaphor is flexible enough to represent many types of data. For example, a flight search form on Expedia can be represented as a single row, with a column corresponding to each input. <span class="pdf-only"></span></p>
<video width="100%" controls="controls" preload="auto" muted="muted" src="media/expedia-table.mp4#t=0.1" muted playsinline controls class>
</video>
<p>In previous examples the table cells were read-only; users cannot change the name or price of an Airbnb listing. In this next case, the cells are writable, so that changes in the table are reflected in the form inputs. This becomes especially useful when combined with GUI widgets that can edit the value of a table cell.</p>
<p>Filling in dates for a flight search typically requires opening up a separate calendar app to find the right dates and then manually copying them into the form. In Wildcard, the user can avoid this cumbersome workflow by using a datepicker widget that includes the user’s personal calendar information<span class="pdf-only"></span>. The user can directly click on the right date, and it gets inserted into the spreadsheet and the original form.</p>
<video width="100%" controls="controls" preload="auto" muted="muted" src="media/datepicker.mp4#t=0.1" muted playsinline controls class>
</video>
<p>Here we’ve presented just a few use cases for spreadsheet-driven customization, but we think the interactive data table is flexible enough to support a wide range of other useful modifications, all while remaining familiar and easy to use.</p>
<h1 data-number="3" id="system-architecture" data-number="3"><span class="header-section-number">3</span> System Architecture</h1>
<p>Wildcard is written in Typescript. It is currently injected into pages using the <a href="https://www.tampermonkey.net/">Tampermonkey</a> userscript manager, but in the future we plan to deploy it as a standalone browser extension to make it easier to install.</p>
<p>In order to promote extensibility, Wildcard is implemented as a small core program along with several types of plugins: site adapters, formulas, and cell renderers/editors. The core contains functionality for displaying the data table and handling user interactions, and the table implementation is built using the <a href="https://handsontable.com/">Handsontable</a> Javascript library.</p>
<figure>
<img src="media/architecture-clean.png" id="fig:architecture" alt="" /><figcaption>The architecture of the Wildcard system</figcaption>
</figure>
<p>Site adapters are a key part of Wildcard, since they specify the bidirectional connection between the web page and its structured data representation.</p>
<p>Wildcard provides an interface for concisely expressing how the DOM should be mapped to a data table. For example, here is a code snippet for extracting the name of an Airbnb listing:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>  fieldName<span class="op">:</span> <span class="st">&quot;name&quot;</span><span class="op">,</span> <span class="co">// The name of the field</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  type<span class="op">:</span> <span class="st">&quot;text&quot;</span><span class="op">,</span>      <span class="co">// The type of the field</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  readOnly<span class="op">:</span> <span class="kw">true</span><span class="op">,</span>    <span class="co">// Whether the user can edit the field</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  el<span class="op">:</span> (row) <span class="kw">=&gt;</span> <span class="va">row</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="vs">`.</span><span class="sc">${</span>titleClass<span class="sc">}</span><span class="vs">`</span>)<span class="op">,</span> <span class="co">// Extract DOM element</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="op">}</span></span></code></pre></div>
<p>Sometimes important data is not shown in the UI, making it impossible to scrape from the DOM. To address this, we have also prototyped mechanisms for site adapters to observe AJAX requests made by the browser and extract data directly from JSON responses. This mechanism was used to implement the Airbnb Walkscore example, since latitude and longitude aren’t shown in the Airbnb UI, but they are available in AJAX responses. In the future we also plan to add the ability for site adapters to scrape data across multiple pages in paginated lists of results (as explored in prior work <span class="citation" data-cites="huynh2006">[<a href="#ref-huynh2006" role="doc-biblioref">10</a>]</span>).</p>
<p>The site adapter also needs to support the reverse direction: sending updates from the table to the original page. Most DOM manipulation is not performed directly by the site adapter. Instead, Wildcard automatically mutates the DOM to reflect the table state, using the same declarative spec shown above. The only exception is row actions (like favoriting an Airbnb listing), which are implemented as imperative Javascript functions that can can mutate the DOM, simulate clicks on buttons, etc.</p>
<h1 data-number="4" id="design-principles" data-number="4"><span class="header-section-number">4</span> Design principles</h1>
<p>The idea of spreadsheet-driven customization is guided by several design principles, inspired by prior work and our own experimentation. We think these principles can also broadly inform the design of tools for end user software customization.</p>
<h2 data-number="4.1" id="expose-a-universal-data-structure" data-number="4.1"><span class="header-section-number">4.1</span> Expose a universal data structure</h2>
<p>Today, most personal computing consists of using applications, which bundle together behavior and data to provide some set of functionality. While there are some limited points of interoperability, applications generally are designed to operate independently of one another.</p>
<p>Computing does not need to be organized this way. For example, UNIX offers a compelling alternative design: many small single-purpose utilities, all of which manipulate a universal format of text streams. The universal format creates a high degree of leverage from tools: users can get a lot of utility from deeply mastering a text editor and some text manipulation utilities, because these tools can be applied to nearly any task. As just one example, a user’s preferred text editor can even serve as an interactive input mechanism in shell programs, e.g. for editing git commit messages.</p>
<p>Spreadsheet-driven customization aims to bring some of this UNIX ethos to the world of isolated Web applications, by creating a consistent data structure to represent the data inside many applications. In UNIX, the universal format is a text stream; in Wildcard, it is a relational table. The table is a simple abstraction which is also generic enough to describe the data used in many different applications. Because Wildcard maps the data from all applications to the table format, users can invest in mastering the Wildcard table editor, the formula language, and cell editor UIs, and reuse those same tools to customize many different applications.</p>
<p>This idea relates to Beaudouin-Lafon and Mackay’s notion of <em>polymorphic interface instruments</em> <span class="citation" data-cites="beaudouin-lafon2000">[<a href="#ref-beaudouin-lafon2000" role="doc-biblioref">2</a>]</span>: UI elements that can be used in different contexts, like a color picker that can be used in many different drawing applications. diSessa has also noted the connection between literacy and the genericness of a medium. Textual literacy rests on the fact that writing can be adapted to many different genres and uses <span class="citation" data-cites="disessa2000">[<a href="#ref-disessa2000" role="doc-biblioref">7</a>]</span>; if people needed to relearn reading and writing from scratch when switching from essays to emails, the medium would lose most of its potency. We think providing generic tools is especially important for software customization, because the most common barrier to customizing software is not having enough time <span class="citation" data-cites="mackay1991">[<a href="#ref-mackay1991" role="doc-biblioref">18</a>]</span>—it’s more likely that people will customize software regularly if they can reuse the same tool across many applications.</p>
<p>This design principle leads to several challenges. First, any universal abstraction has its constraints, and can’t necessarily naturally express the data in every application. We plan to explore the limits of the table abstraction further, by trying to build adapters for more sites with varied data formats. We expect that many types of data can fit fairly naturally into tables: lists of search results, news articles, and messages can all be seen as relations. On sites that use document structures (e.g. Google Docs) or graph structures (e.g. social friend graphs), it may prove more challenging to map internal data to this abstraction.</p>
<p>Another challenge is ensuring a clear mapping in the user’s mind between the spreadsheet and the original page. Wildcard provides live visual cues as the user navigates the data table (similar to the highlighting provided by DOM inspectors in browser developer tools). In our own usage, we have found that this live highlighting makes it very clear how the two representations map to each other.</p>
<h2 data-number="4.2" id="low-floor-high-ceiling" data-number="4.2"><span class="header-section-number">4.2</span> Low floor, high ceiling</h2>
<p>Seymour Papert advocated for programming systems to have a “low floor,” making it easy for novices to get started, and a “high ceiling,” providing a large range of possibilities for more sophisticated users <span class="citation" data-cites="resnick2016">[<a href="#ref-resnick2016" role="doc-biblioref">22</a>]</span>. Our goal is for spreadsheet-driven customization to meet both of these criteria.</p>
<p>One of the most interesting properties of spreadsheets is that users who are only know a tiny sliver of their functionality (e.g., storing tables of numbers or computing simple sums) can still use them in genuinely valuable ways. The fact that useful tasks can be performed early on supports the user’s natural motivation to continue using the tool, and to eventually learn its more powerful features if needed <span class="citation" data-cites="nardi1991">[<a href="#ref-nardi1991" role="doc-biblioref">21</a>]</span>. In contrast, many traditional programming systems require an enormous upfront investment of time and practice before someone is able to write a program that helps them achieve a useful task in their life.</p>
<p>As part of ensuring a low floor, we have focused on including genuinely valuable features for novices. For example, a user can sort a table with a single click, or simply type in some annotations. We would expect many Wildcard users to start by using these simpler features before potentially moving on to more sophisticated features like formulas.</p>
<p>Another aspect of providing a low floor is providing an “in-place toolchain” <span class="citation" data-cites="inkandswitch2019">[<a href="#ref-inkandswitch2019" role="doc-biblioref">13</a>]</span>: minimizing the effort of moving from using to customizing, by making customization tools available in the same environment where the user is already using the software. This quality is distinct from the level of technical skill needed to use the tool. For example, setting up a workflow trigger in an end user programming system like <a href="https://ifttt.com/">IFTTT</a> does not require much technical skill, but does require leaving the user’s normal software and entering a separate environment; conversely, running a Javascript snippet in the browser console requires programming skills, but can be done immediately and casually in the flow of using a website.</p>
<table>
<tbody>
<tr class="odd">
<td></td>
<td style="text-align: left;"><em>In-place</em></td>
<td style="text-align: center;"><em>Not in-place</em></td>
</tr>
<tr class="even">
<td><em>End user friendly</em></td>
<td style="text-align: left;"><strong>Wildcard</strong></td>
<td style="text-align: center;">IFTTT</td>
</tr>
<tr class="odd">
<td><em>Requires programming</em></td>
<td style="text-align: left;">browser JS console</td>
<td style="text-align: center;">forking open source software</td>
</tr>
</tbody>
</table>
<p>Wildcard provides an in-place toolchain because the spreadsheet can be instantly opened in the browser window while using any supported website. Once the user starts editing, Wildcard also provides live feedback, so that even if a user isn’t yet totally familiar with Wildcard, they can learn to use the system through experimentation.</p>
<p>Since we have still only built several site adapters and demos, it is still too early to tell exactly how high the ceiling is for the customizations that can be achieved with Wildcard. But we think that with enough operators, the formula language could support a wide variety of customizations—people have managed to use simple spreadsheet formula languages to solve a surprisingly large range of problems. We plan to explore this aspect further by trying to solve more real problems with the system and observing where limitations emerge in practice.</p>
<h2 data-number="4.3" id="build-for-multiple-tiers-of-users" data-number="4.3"><span class="header-section-number">4.3</span> Build for multiple tiers of users</h2>
<p>Real-world spreadsheet usage in offices is highly collaborative: most users just perform simple changes, while a few coworkers help with writing more complex formulas or even programming macros <span class="citation" data-cites="nardi1990">[<a href="#ref-nardi1990" role="doc-biblioref">20</a>]</span>. Inspired by this collaborative approach, we aim to make spreadsheet-driven customization a collaborative activity that combines the different abilities of many users.</p>
<p>The main way we do this is by separating website customization into two separate stages: structured data extraction, and using the resulting spreadsheet. The data extraction stage is currently only available to programmers who can code site adapters in Javascript, whereas the customization stage is available to any non-programmer end user. This architecture frees end users from needing to think about data extraction, and enables a community of end users to reuse the efforts of programmers building site adapters.</p>
<p>The group of users building adapters does not necessarily need to be limited only to programmers. In the future, we plan to explore enabling end users to also create site adapters, drawing on related work in this area <span class="citation" data-cites="chasins2018 huynh2006">[<a href="#ref-chasins2018" role="doc-biblioref">6</a>, <a href="#ref-huynh2006" role="doc-biblioref">10</a>]</span>. But even in that case, we still envision a separation between highly motivated, tech-savvy end users building adapters, and more casual end users just using the spreadsheet view.</p>
<p>Another stakeholder to consider is the first party developers of the original software. Spreadsheet-driven customization does not depend on cooperation from first-party website developers, but if they were to expose structured data in their web application clients, it would make site adapters unnecessary, producing more robust results with much less work.</p>
<p>We think there are compelling reasons for first parties to consider doing this. Providing Wildcard support would allow users to build extensions to fulfill their own feature requests. It also would not necessarily require much effort: adding Wildcard support could be made fairly straightforward for a first-party that already has direct access to the structured data in the page. There is also precedent for first parties implementing an official client extension API in response to user demand: for several years, Google maintained an official extension API in Gmail for Greasemonkey scripts to use.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<h1 data-number="5" id="related-work" data-number="5"><span class="header-section-number">5</span> Related work</h1>
<h2 data-number="5.1" id="malleable-software" data-number="5.1"><span class="header-section-number">5.1</span> Malleable software</h2>
<p>In the broadest sense, Wildcard is inspired by systems aiming to make software into a dynamic medium where end users frequently create and modify software to meet their own needs, rather than only consuming applications built by programmers. These systems include Smalltalk <span class="citation" data-cites="kay1977">[<a href="#ref-kay1977" role="doc-biblioref">14</a>]</span>, Hypercard <span class="citation" data-cites="hypercard2019">[<a href="#ref-hypercard2019" role="doc-biblioref">12</a>]</span> , Boxer <span class="citation" data-cites="disessa1986">[<a href="#ref-disessa1986" role="doc-biblioref">8</a>]</span>, Webstrates <span class="citation" data-cites="klokmose2015">[<a href="#ref-klokmose2015" role="doc-biblioref">15</a>]</span>, and Dynamicland <span class="citation" data-cites="victor">[<a href="#ref-victor" role="doc-biblioref">25</a>]</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>While similar in broad goals, Wildcard employs a different solution strategy. These projects generally require building software from scratch in a new environment, whereas Wildcard aims to maximize the malleability of software built with existing tools. This approach has the pragmatic benefit of enabling customization for much more software, although it also imposes more rigid constraints.</p>
<p>With substantial future work, we think Wildcard could become more similar to these other projects, growing from a platform for tweaking existing software into a platform for building new software from scratch. This would likely end up resembling existing tools for building spreadsheet-driven applications (discussed more below), but with an additional focus on customizability by end users of the software.</p>
<h2 data-number="5.2" id="web-customization" data-number="5.2"><span class="header-section-number">5.2</span> Web customization</h2>
<p>Wildcard’s goals are closely shared with other systems that provide interfaces in the browser for end users to augment and customize websites while using them.</p>
<h3 data-number="5.2.1" id="structured-augmentation" data-number="5.2.1"><span class="header-section-number">5.2.1</span> Structured augmentation</h3>
<p>Wildcard’s solution approach is most similar to other tools that identify structured data in a web page, and then use that structure to support end user customization of the page.</p>
<p>Sifter <span class="citation" data-cites="huynh2006">[<a href="#ref-huynh2006" role="doc-biblioref">10</a>]</span> enables users to sort and filter lists of data on web pages, which resembles Wildcard’s sort and filter functionality. The underlying mechanism is also similar, since Sifter extracts structured data from the page to enable its user-facing functionality. The systems also have major differences. Wildcard aims to extend this approach to support much broader functionality, and shows the structured data table directly to the user. In contrast, Sifter only supports sorting and filtering, and does not reveal the underlying data table. The extraction mechanism is also different: Sifter uses a combination of automated heuristics and interactive user feedback to enable end users to extract data, whereas Wildcard hides data extraction from end users.</p>
<p>Thresher <span class="citation" data-cites="hogue2005">[<a href="#ref-hogue2005" role="doc-biblioref">9</a>]</span> enables users to create wrappers which map unstructured website content to Semantic Web content. Like Wildcard and Sifter, Thresher augments the experience of original page based on identifying structure; once semantic content has been identified, it creates context menus in the original website which allow users to take actions based on that content. Wildcard and Thresher focus on complementary parts of the problem. Thresher aims to enable end users to create content wrappers, but the actions available on the structured data are created by programmers; conversely, Wildcard delegates wrapper creation to programmers but gives end users more flexibility to use the structured data in an open-ended way.</p>
<h3 data-number="5.2.2" id="sloppy-augmentation" data-number="5.2.2"><span class="header-section-number">5.2.2</span> Sloppy augmentation</h3>
<p>“Sloppy programming” <span class="citation" data-cites="little2010">[<a href="#ref-little2010" role="doc-biblioref">17</a>]</span> tools like Chickenfoot <span class="citation" data-cites="bolin2005">[<a href="#ref-bolin2005" role="doc-biblioref">4</a>]</span> and Coscripter <span class="citation" data-cites="leshed2008">[<a href="#ref-leshed2008" role="doc-biblioref">16</a>]</span> enable users to create scripts that perform actions like filling in text boxes and clicking buttons, without directly interacting with the DOM. Users express the desired page elements in natural, informal terms (e.g. writing “the username box” to represent the textbook closest to the label “username”), and then using heuristics to determine which elements most likely match the user’s intent. This approach allows for expressing a wide variety of commands with minimal training, but it also has downsides <span class="citation" data-cites="little2010">[<a href="#ref-little2010" role="doc-biblioref">17</a>]</span>:</p>
<ul>
<li>Reliability: It can be difficult to know whether a command will consistently work over time. In addition to changes to the website, changes to the heuristics can also cause problems.</li>
<li>Discoverability: it can be difficult for users to discover the space of possible commands.</li>
</ul>
<p>Wildcard offers a sharp contrast to sloppy programming, instead choosing to expose a high degree of structure through the familiar spreadsheet table. Wildcard offers more consistency; for example, clicking a sort header will always work correctly as long as the site adapter is maintained. Wildcard also offers clearer affordances for what types of actions are possible, or, crucially, what actions are <em>not</em> possible, which is useful to know. On the other hand, Wildcard’s explicit site adapter approach will result in coverage of many fewer websites, and also a narrower range of possible actions than “sloppy” tools.</p>
<h2 data-number="5.3" id="spreadsheet-based-app-builders" data-number="5.3"><span class="header-section-number">5.3</span> Spreadsheet-based app builders</h2>
<p>Many others have made the powerful realization that a spreadsheet can serve as an backing data store and computation layer for an interactive web application, enabling end users to create such applications more easily. Research projects like Object Spreadsheets <span class="citation" data-cites="mccutchen2016">[<a href="#ref-mccutchen2016" role="doc-biblioref">19</a>]</span>, Quilt <span class="citation" data-cites="benson2014">[<a href="#ref-benson2014" role="doc-biblioref">3</a>]</span>, Gneiss <span class="citation" data-cites="chang2014">[<a href="#ref-chang2014" role="doc-biblioref">5</a>]</span>, and Marmite <span class="citation" data-cites="wong2007">[<a href="#ref-wong2007" role="doc-biblioref">26</a>]</span>, as well as commercial tools like Airtable Blocks <span class="citation" data-cites="zotero-79">[<a href="#ref-zotero-79" role="doc-biblioref">27</a>]</span> and Glide <span class="citation" data-cites="zotero-81">[<a href="#ref-zotero-81" role="doc-biblioref">28</a>]</span> allow users to view data in a spreadsheet table, compute over the data using formulas, and then connect the table to a GUI. Because many users are already familiar with using spreadsheets, this way of creating applications tends to be much easier than traditional software methods; for example, in a user study of Quilt, many users were able to create applications in under 10 minutes, even if they expected it would take them many hours.</p>
<p>Wildcard builds on this idea, but applies it to modifying existing applications, rather than building new applications from scratch. For many people, we suspect that tweaking existing applications provides more motivation as a starting point for programming than creating a new application from scratch.</p>
<p>An important design decision for tools in this space is how to deviate from traditional spreadsheets like Microsoft Excel or Google Sheets. Quilt and Glide use existing spreadsheet software as a backend, providing maximum familiarity for users, and even compatibility with existing spreadsheets. Gneiss has its own spreadsheet implementation with additional features useful for building GUIs. Marmite provides a live data view that resembles a spreadsheet, but programming is actually done using a separate data flow pane rather than spreadsheet formulas. (Marmite’s approach led to some confusion in a user study, because users expected behavior more similar to spreadsheets <span class="citation" data-cites="wong2007">[<a href="#ref-wong2007" role="doc-biblioref">26</a>]</span>.) Airtable deviates the furthest: although the user interface resembles a spreadsheet, the underlying structure is a relational database with typed columns. Wildcard’s table is most similar to Airtable; the structure of a relational table is most appropriate for most data in websites, and we have not yet found a need for arbitrary untyped cells.</p>
<h2 data-number="5.4" id="web-scraping-data-extraction" data-number="5.4"><span class="header-section-number">5.4</span> Web scraping / data extraction</h2>
<p>Web scraping tools focus on extracting structured data out of unstructured web pages. Web scraping is closely related to the implementation of Wildcard, but has different end goals: web scraping generally extracts static data for processing in another environment, whereas Wildcard customizes the application’s UI by maintaining a bidirectional connection between the extracted data and the page.</p>
<p>Web scraping tools differ in how much structure they attempt to map onto the data. Some tools like Rousillon <span class="citation" data-cites="chasins2018">[<a href="#ref-chasins2018" role="doc-biblioref">6</a>]</span> extract data in a minimally structured relational format; other tools like Piggy Bank <span class="citation" data-cites="huynh2005">[<a href="#ref-huynh2005" role="doc-biblioref">11</a>]</span> more ambitiously map the data to a rich semantic schema. In Wildcard, we chose to avoid schemas, in order to minimize the work associated with creating a site adapter.</p>
<p>In the future, we might be able to integrate web scraping tools to help create more reliable site adapters for Wildcard with less work, and to open up adapter creation to end users. Sifter was built on top of the Piggy Bank scraping library, suggesting precisely this type of architecture where web scraping tools are used to support interactive page modification.</p>
<h1 data-number="6" id="future-work" data-number="6"><span class="header-section-number">6</span> Future work</h1>
<p>There are still many open questions about spreadsheet-driven customization which we hope to answer through targeted development and usage of the Wildcard prototype.</p>
<p>The most important question is: where are the limits of this computational model? What types of useful customizations can it support or not support? While initial demos suggest a variety of use cases, we plan to develop more site adapters and demos to explore this question further. We will start with privately testing the system with our own needs, and then eventually deploy the tool publicly, once the API is stable enough and can support a critical mass of sites and use cases. We also plan to run usability studies to evaluate and improve the design of the tool.</p>
<p>We suspect that two areas of the current model may prove limiting. First, Wildcard’s data model currently shows a single table at a time, without any notion of relationships between tables. A richer data model with foreign keys might help support certain use cases. For designing a spreadsheet interface on top of a richer relational model, we could learn from other systems with this design <span class="citation" data-cites="mccutchen2016 bakke2016">[<a href="#ref-bakke2016" role="doc-biblioref">1</a>, <a href="#ref-mccutchen2016" role="doc-biblioref">19</a>]</span>.</p>
<p>A second potential limitation is that there is currently no mechanism for end users to express imperative workflows with sequences of actions, which related work has shown to be useful <span class="citation" data-cites="bolin2005 leshed2008">[<a href="#ref-bolin2005" role="doc-biblioref">4</a>, <a href="#ref-leshed2008" role="doc-biblioref">16</a>]</span>. It’s not clear how such workflows could fit into Wildcard, since spreadsheets have a fundamentally different computation model, and site adapters created by programmers cannot easily account for every possible action a user would want to take in a page.</p>
<p>Another open question is how efficiently site adapters can be created for real websites, which often include complex markup. We plan to explore this question by creating adapters for sites with different data structures and in different domains, and perhaps running user tests with programmers. Possible future improvements we’ve considered include developing automated heuristics to assist with the adapter creation process, and developing new abstractions that make it easier for programmers to efficiently create new robust adapters.</p>
<h1 data-number="7" id="conclusion" data-number="7"><span class="header-section-number">7</span> Conclusion</h1>
<p>In this paper, we have presented <em>spreadsheet-driven customization</em>, a technique that enables end users to customize software by augmenting an application’s UI with a spreadsheet. We hope that this technique contributes to making the Web into a more dynamic medium that users can mold to their own needs.</p>
<p>We plan to continue developing the Wildcard prototype and to eventually deploy it as an open-source tool. To receive future updates on Wildcard and notifications about a public release, <a href="">sign up for the email newsletter</a>.</p>
<p>We are also looking for private beta testers. If you have an idea for how you might want to use Wildcard, please <a href="mailto:glitt@mit.edu">get in touch</a>. We would love to hear about your needs and help find ways to use Wildcard to solve them.</p>
<h1 class="unnumbered" data-number="" id="bibliography" class="unnumbered" data-number="">References</h1>
<div id="refs" class="references" role="doc-bibliography">
<div id="ref-bakke2016">
<p>[1] Bakke, E. and Karger, D.R. 2016. Expressive Query Construction through Direct Manipulation of Nested Relational Results. <em>Proceedings of the 2016 International Conference on Management of Data - SIGMOD ’16</em> (San Francisco, California, USA, 2016), 1377–1392.</p>
</div>
<div id="ref-beaudouin-lafon2000">
<p>[2] Beaudouin-Lafon, M. and Mackay, W.E. 2000. Reification, Polymorphism and Reuse: Three Principles for Designing Visual Interfaces. <em>Proceedings of the Working Conference on Advanced Visual Interfaces</em> (Palermo, Italy, 2000), 102–109.</p>
</div>
<div id="ref-benson2014">
<p>[3] Benson, E. et al. 2014. Spreadsheet driven web applications. <em>Proceedings of the 27th annual ACM symposium on User interface software and technology - UIST ’14</em> (Honolulu, Hawaii, USA, 2014), 97–106.</p>
</div>
<div id="ref-bolin2005">
<p>[4] Bolin, M. et al. 2005. Automation and customization of rendered web pages. <em>Proceedings of the 18th annual ACM symposium on User interface software and technology - UIST ’05</em> (Seattle, WA, USA, 2005), 163.</p>
</div>
<div id="ref-chang2014">
<p>[5] Chang, K.S.-P. and Myers, B.A. 2014. Creating interactive web data applications with spreadsheets. <em>Proceedings of the 27th annual ACM symposium on User interface software and technology - UIST ’14</em> (Honolulu, Hawaii, USA, 2014), 87–96.</p>
</div>
<div id="ref-chasins2018">
<p>[6] Chasins, S.E. et al. 2018. Rousillon: Scraping Distributed Hierarchical Web Data. <em>The 31st Annual ACM Symposium on User Interface Software and Technology - UIST ’18</em> (Berlin, Germany, 2018), 963–975.</p>
</div>
<div id="ref-disessa2000">
<p>[7] diSessa, A.A. 2000. <em>Changing Minds: Computers, Learning, and Literacy</em>. MIT Press.</p>
</div>
<div id="ref-disessa1986">
<p>[8] diSessa, A.A. and Abelson, H. 1986. Boxer: A reconstructible computational medium. <em>Communications of the ACM</em>. 29, 9 (Sep. 1986), 859–868. DOI:<a href="https://doi.org/10.1145/6592.6595">https://doi.org/10.1145/6592.6595</a>.</p>
</div>
<div id="ref-hogue2005">
<p>[9] Hogue, A. and Karger, D. 2005. Thresher: Automating the unwrapping of semantic content from the World Wide Web. <em>Proceedings of the 14th international conference on World Wide Web - WWW ’05</em> (Chiba, Japan, 2005), 86.</p>
</div>
<div id="ref-huynh2006">
<p>[10] Huynh, D.F. et al. 2006. Enabling web browsers to augment web sites’ filtering and sorting functionalities. <em>Proceedings of the 19th annual ACM symposium on User interface software and technology - UIST ’06</em> (Montreux, Switzerland, 2006), 125.</p>
</div>
<div id="ref-huynh2005">
<p>[11] Huynh, D. et al. 2005. Piggy Bank: Experience the Semantic Web Inside Your Web Browser. <em>The Semantic Web ISWC 2005</em> (Berlin, Heidelberg, 2005), 413–430.</p>
</div>
<div id="ref-hypercard2019">
<p>[12] Hypercard 2019. HyperCard. <em>Wikipedia</em>. (Dec. 2019).</p>
</div>
<div id="ref-inkandswitch2019">
<p>[13] Ink and Switch 2019. End-user programming. <em>Ink and Switch</em>.</p>
</div>
<div id="ref-kay1977">
<p>[14] Kay, A. and Goldberg, A. 1977. Personal Dynamic Media. <em>Computer</em>. 10, 3 (Mar. 1977), 31–41. DOI:<a href="https://doi.org/10.1109/C-M.1977.217672">https://doi.org/10.1109/C-M.1977.217672</a>.</p>
</div>
<div id="ref-klokmose2015">
<p>[15] Klokmose, C.N. et al. 2015. Webstrates: Shareable Dynamic Media. <em>Proceedings of the 28th Annual ACM Symposium on User Interface Software &amp; Technology - UIST ’15</em> (Daegu, Kyungpook, Republic of Korea, 2015), 280–290.</p>
</div>
<div id="ref-leshed2008">
<p>[16] Leshed, G. et al. 2008. CoScripter: Automating &amp; Sharing How-to Knowledge in the Enterprise. <em>Proceedings of the SIGCHI Conference on Human Factors in Computing Systems</em> (Florence, Italy, 2008), 1719–1728.</p>
</div>
<div id="ref-little2010">
<p>[17] Little, G. et al. 2010. Sloppy programming. <em>No Code Required</em>. Elsevier. 289–307.</p>
</div>
<div id="ref-mackay1991">
<p>[18] Mackay, W.E. 1991. Triggers and barriers to customizing software. <em>Proceedings of the SIGCHI conference on Human factors in computing systems Reaching through technology - CHI ’91</em> (New Orleans, Louisiana, United States, 1991), 153–160.</p>
</div>
<div id="ref-mccutchen2016">
<p>[19] McCutchen, M. et al. 2016. Object spreadsheets: A new computational model for end-user development of data-centric web applications. <em>Proceedings of the 2016 ACM International Symposium on New Ideas, New Paradigms, and Reflections on Programming and Software - Onward! 2016</em> (Amsterdam, Netherlands, 2016), 112–127.</p>
</div>
<div id="ref-nardi1990">
<p>[20] Nardi, B.A. and Miller, J.R. 1990. An Ethnographic Study of Distributed Problem Solving in Spreadsheet Development. (1990), 197–208.</p>
</div>
<div id="ref-nardi1991">
<p>[21] Nardi, B.A. and Miller, J.R. 1991. Twinkling lights and nested loops: Distributed problem solving and spreadsheet development. <em>International Journal of Man-Machine Studies</em>. 34, 2 (Feb. 1991), 161–184. DOI:<a href="https://doi.org/10.1016/0020-7373(91)90040-E">https://doi.org/10.1016/0020-7373(91)90040-E</a>.</p>
</div>
<div id="ref-resnick2016">
<p>[22] Resnick, M. 2016. Designing for Wide Walls. <em>Design.blog</em>.</p>
</div>
<div id="ref-streak">
<p>[23] Streak InboxSDK. https://www.inboxsdk.com/.</p>
</div>
<div id="ref-talwar2019">
<p>[24] Talwar, K. 2019. Gmail.Js. <em>GitHub</em>. https://github.com/KartikTalwar/gmail.js.</p>
</div>
<div id="ref-victor">
<p>[25] Victor, B. Dynamicland. https://dynamicland.org/.</p>
</div>
<div id="ref-wong2007">
<p>[26] Wong, J. and Hong, J.I. 2007. Making mashups with marmite: Towards end-user programming for the web. <em>Proceedings of the SIGCHI Conference on Human Factors in Computing Systems - CHI ’07</em> (San Jose, California, USA, 2007), 1435–1444.</p>
</div>
<div id="ref-zotero-79">
<p>[27] Airtable: Organize anything you can imagine. <em>Airtable</em>. https://airtable.com.</p>
</div>
<div id="ref-zotero-81">
<p>[28] Create an App from a Google Sheet in Minutes <span class="math inline">⋅</span> Glide. https://www.glideapps.com/.</p>
</div>
</div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Incidentally, since then, third parties have continued to maintain stable Gmail extension APIs used by many browser extensions <span class="citation" data-cites="streak talwar2019">[<a href="#ref-streak" role="doc-biblioref">23</a>, <a href="#ref-talwar2019" role="doc-biblioref">24</a>]</span>, illustrating the potential of collaboratively maintaining third party adapters.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>The project’s name Wildcard comes from the internal pre-release name for Hypercard, which doubly inspired our work by promoting both software modification by end users and the ideas behind the Web.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<h2 id="acks">Acknowledgements</h2>
Thank you to Glen Chiacchieri, Steve Krouse, Daniel Windham, and Maggie Yellen for providing helpful feedback on this work.
<br /><br />
</body>
</html>